2025-07-10 13:57:09 - telegram_bot - INFO - Проверка переменных окружения успешно пройдена
2025-07-10 13:57:09 - telegram_bot - INFO - Инициализация базы данных...
2025-07-10 13:57:09 - telegram_bot - INFO - Начальные данные успешно созданы
2025-07-10 13:57:09 - telegram_bot - INFO - Обновление прав доступа для ролей...
2025-07-10 13:57:09 - telegram_bot - INFO - Право create_tests удалено у роли 2
2025-07-10 13:57:09 - telegram_bot - INFO - Право edit_tests удалено у роли 2
2025-07-10 13:57:09 - telegram_bot - INFO - Удалены права create_tests и edit_tests у роли Сотрудник
2025-07-10 13:57:09 - telegram_bot - INFO - Обновление прав доступа завершено
2025-07-10 13:57:09 - telegram_bot - INFO - Настройка команд бота...
2025-07-10 13:57:09 - telegram_bot - INFO - Запуск бота...
2025-07-10 13:57:47 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) started bot - not registered
2025-07-10 13:57:48 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) started registration
2025-07-10 13:57:54 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) provided full name. Данные: {'full_name': 'Тест Рекрутер'}
2025-07-10 13:57:58 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) provided phone manually. Данные: {'phone': '+79034005751'}
2025-07-10 13:58:02 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) completed registration. Данные: {'role': 'Рекрутер', 'full_name': 'Тест Рекрутер'}
2025-07-10 13:58:04 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) successful login. Данные: {'role': 'Рекрутер', 'user_id': 1}
2025-07-10 13:58:24 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) attempted to register again
2025-07-10 13:58:29 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) successful login. Данные: {'role': 'Рекрутер', 'user_id': 1}
2025-07-10 13:58:54 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) started bot - not registered
2025-07-10 13:58:57 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) started registration
2025-07-10 13:59:02 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) provided full name. Данные: {'full_name': 'Тест Наставник'}
2025-07-10 13:59:09 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) provided phone manually. Данные: {'phone': '+79993004546'}
2025-07-10 13:59:16 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) completed registration. Данные: {'role': 'Сотрудник', 'full_name': 'Тест Наставник'}
2025-07-10 13:59:29 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) started bot - already registered
2025-07-10 13:59:30 - telegram_bot - INFO - Пользователь 7233422441 (@creatymoment) successful login from start. Данные: {'role': 'Сотрудник', 'user_id': 2}
2025-07-10 13:59:45 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) started bot - not registered
2025-07-10 13:59:46 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) started registration
2025-07-10 13:59:52 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) provided full name. Данные: {'full_name': 'Тест Стажёр'}
2025-07-10 14:00:00 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) provided phone manually. Данные: {'phone': '+79993883436'}
2025-07-10 14:00:04 - telegram_bot - INFO - Уведомление о новом стажёре 'Тест Стажёр' отправлено рекрутеру 913964240
2025-07-10 14:00:04 - telegram_bot - INFO - Уведомления о новом стажёре отправлены 1/1 рекрутерам
2025-07-10 14:00:04 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) completed registration. Данные: {'role': 'Стажер', 'full_name': 'Тест Стажёр'}
2025-07-10 14:00:15 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) cancelled admin operation
2025-07-10 14:01:42 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) auto authentication. Данные: {'role': 'Рекрутер', 'user_id': 1}
2025-07-10 14:01:42 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) viewed mentors list
2025-07-10 14:01:50 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) viewed trainees list
2025-07-10 14:01:56 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) viewed mentors list
2025-07-10 14:02:05 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) cancelled admin operation
2025-07-10 14:02:08 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) auto authentication. Данные: {'role': 'Рекрутер', 'user_id': 1}
2025-07-10 14:02:08 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) opened mentor assignment
2025-07-10 14:02:12 - telegram_bot - INFO - Наставник Тест Наставник назначен стажеру Тест Стажёр
2025-07-10 14:02:12 - telegram_bot - INFO - Уведомление о назначении наставника 'Тест Наставник' отправлено стажеру 6998855824
2025-07-10 14:02:12 - telegram_bot - INFO - Уведомление о назначении стажёра 'Тест Стажёр' отправлено наставнику 7233422441
2025-07-10 14:02:12 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) assigned mentor. Данные: {'mentor_id': 2, 'trainee_id': 3}
2025-07-10 14:26:24 - telegram_bot - INFO - Завершение работы...
2025-07-10 14:26:24 - telegram_bot - INFO - Бот остановлен
2025-07-10 14:26:24 - telegram_bot - INFO - Бот остановлен по прерыванию с клавиатуры
2025-07-10 14:53:41 - telegram_bot - INFO - Проверка переменных окружения успешно пройдена
2025-07-10 14:53:41 - telegram_bot - INFO - Инициализация базы данных...
2025-07-10 14:53:41 - telegram_bot - INFO - Обновление прав доступа для ролей...
2025-07-10 14:53:41 - telegram_bot - INFO - Право create_tests удалено у роли 2
2025-07-10 14:53:41 - telegram_bot - INFO - Право edit_tests удалено у роли 2
2025-07-10 14:53:41 - telegram_bot - INFO - Удалены права create_tests и edit_tests у роли Сотрудник
2025-07-10 14:53:41 - telegram_bot - INFO - Обновление прав доступа завершено
2025-07-10 14:53:41 - telegram_bot - INFO - Настройка команд бота...
2025-07-10 14:53:42 - telegram_bot - INFO - Запуск бота...
2025-07-10 14:53:54 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) started bot - already registered
2025-07-10 14:53:54 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 1}
2025-07-10 15:20:43 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started bot - not registered
2025-07-10 15:20:47 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started registration
2025-07-10 15:20:57 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) provided full name. Данные: {'full_name': 'Глеб - Стажёр'}
2025-07-10 15:21:01 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) provided phone manually. Данные: {'phone': '+79891988598'}
2025-07-10 15:21:06 - telegram_bot - INFO - Уведомление о новом стажёре 'Глеб - Стажёр' отправлено рекрутеру 913964240
2025-07-10 15:21:06 - telegram_bot - INFO - Уведомления о новом стажёре отправлены 1/1 рекрутерам
2025-07-10 15:21:06 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) completed registration. Данные: {'role': 'Стажер', 'full_name': 'Глеб - Стажёр'}
2025-07-10 15:21:16 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) auto authentication. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 15:21:33 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) started bot - not registered
2025-07-10 15:21:35 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) started registration
2025-07-10 15:21:37 - telegram_bot - INFO - Пользователь 913964240 (@a1ex_sav) cancelled admin operation
2025-07-10 15:21:50 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) provided full name. Данные: {'full_name': 'Сова - Сотрудник'}
2025-07-10 15:21:56 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) provided phone manually. Данные: {'phone': '+79993332222'}
2025-07-10 15:22:01 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) completed registration. Данные: {'role': 'Сотрудник', 'full_name': 'Сова - Сотрудник'}
2025-07-10 15:22:07 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) started bot - already registered
2025-07-10 15:22:08 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) successful login from start. Данные: {'role': 'Сотрудник', 'user_id': 5}
2025-07-10 15:22:23 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - not registered
2025-07-10 15:22:25 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started registration
2025-07-10 15:22:40 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) provided full name. Данные: {'full_name': 'Акк - Рекрутер'}
2025-07-10 15:22:46 - telegram_bot - ERROR - Пользователь 7197129915 (@EFOR_Development_Department) ошибка: attempted to register with existing phone: +79993332222
2025-07-10 15:23:10 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - not registered
2025-07-10 15:23:11 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started registration
2025-07-10 15:23:17 - telegram_bot - ERROR - Пользователь 7197129915 (@EFOR_Development_Department) ошибка: invalid full name: 89993332211
2025-07-10 15:23:30 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) provided full name. Данные: {'full_name': 'Акк - Рекрутер'}
2025-07-10 15:23:40 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) provided phone manually. Данные: {'phone': '+79993332211'}
2025-07-10 15:23:44 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) completed registration. Данные: {'role': 'Рекрутер', 'full_name': 'Акк - Рекрутер'}
2025-07-10 15:23:49 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) auto authentication. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 15:27:11 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 15:27:12 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 15:27:35 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 15:27:35 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 15:28:02 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed trainees list
2025-07-10 15:28:24 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed mentors list
2025-07-10 15:28:30 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed trainees list
2025-07-10 15:28:36 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed new users list
2025-07-10 15:28:45 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) opened mentor assignment
2025-07-10 15:29:01 - telegram_bot - INFO - Наставник Сова - Сотрудник назначен стажеру Глеб - Стажёр
2025-07-10 15:29:02 - telegram_bot - INFO - Уведомление о назначении наставника 'Сова - Сотрудник' отправлено стажеру 453388874
2025-07-10 15:29:02 - telegram_bot - INFO - Уведомление о назначении стажёра 'Глеб - Стажёр' отправлено наставнику 7118826824
2025-07-10 15:29:02 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) assigned mentor. Данные: {'mentor_id': 5, 'trainee_id': 4}
2025-07-10 15:31:39 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) started bot - already registered
2025-07-10 15:31:39 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) successful login from start. Данные: {'role': 'Сотрудник', 'user_id': 5}
2025-07-10 15:32:31 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 15:32:31 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 15:32:34 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started test creation
2025-07-10 15:37:51 - telegram_bot - INFO - Тест 'Приготовление кофе' создан успешно (ID: 1)
2025-07-10 15:37:51 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) created test with questions. Данные: {'test_id': 1, 'questions_count': 3}
2025-07-10 15:38:13 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) viewed test details. Данные: {'test_id': 1}
2025-07-10 15:38:17 - telegram_bot - INFO - Создан новый доступ к тесту 1 для стажёра 4
2025-07-10 15:38:17 - telegram_bot - INFO - Уведомление о тесте 'Приготовление кофе' отправлено стажеру 453388874
2025-07-10 15:38:17 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) granted test access. Данные: {'test_id': 1, 'trainee_id': 4}
2025-07-10 15:38:36 - telegram_bot - INFO - Доступ к тесту 1 для стажёра 4 уже существует - отправляем повторное уведомление
2025-07-10 15:38:36 - telegram_bot - INFO - Уведомление о тесте 'Приготовление кофе' отправлено стажеру 453388874
2025-07-10 15:38:36 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) granted test access. Данные: {'test_id': 1, 'trainee_id': 4}
2025-07-10 15:38:57 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) took test from notification. Данные: {'test_id': 1}
2025-07-10 15:39:05 - telegram_bot - ERROR - Исключение: Telegram server says - Bad Request: message can't be edited
Обновление: update_id=258257212 message=Message(message_id=2941, date=datetime.datetime(2025, 7, 10, 12, 39, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=453388874, type='private', title=None, username='Saint_Whirlwind', first_name='Глеб', last_name=None, is_forum=None, accent_color_id=None, active_usernames=None, available_reactions=None, background_custom_emoji_id=None, bio=None, birthdate=None, business_intro=None, business_location=None, business_opening_hours=None, can_set_sticker_set=None, custom_emoji_sticker_set_name=None, description=None, emoji_status_custom_emoji_id=None, emoji_status_expiration_date=None, has_aggressive_anti_spam_enabled=None, has_hidden_members=None, has_private_forwards=None, has_protected_content=None, has_restricted_voice_and_video_messages=None, has_visible_history=None, invite_link=None, join_by_request=None, join_to_send_messages=None, linked_chat_id=None, location=None, message_auto_delete_time=None, permissions=None, personal_chat=None, photo=None, pinned_message=None, profile_accent_color_id=None, profile_background_custom_emoji_id=None, slow_mode_delay=None, sticker_set_name=None, unrestrict_boost_count=None), message_thread_id=None, from_user=User(id=453388874, is_bot=False, first_name='Глеб', last_name=None, username='Saint_Whirlwind', language_code='ru', is_premium=None, added_to_attachment_menu=None, can_join_groups=None, can_read_all_group_messages=None, supports_inline_queries=None, can_connect_to_business=None, has_main_web_app=None), sender_chat=None, sender_boost_count=None, sender_business_bot=None, business_connection_id=None, forward_origin=None, is_topic_message=None, is_automatic_forward=None, reply_to_message=None, external_reply=None, quote=None, reply_to_story=None, via_bot=None, edit_date=None, has_protected_content=None, is_from_offline=None, media_group_id=None, author_signature=None, paid_star_count=None, text='НЕТ', entities=None, link_preview_options=None, effect_id=None, animation=None, audio=None, document=None, paid_media=None, photo=None, sticker=None, story=None, video=None, video_note=None, voice=None, caption=None, caption_entities=None, show_caption_above_media=None, has_media_spoiler=None, contact=None, dice=None, game=None, poll=None, venue=None, location=None, new_chat_members=None, left_chat_member=None, new_chat_title=None, new_chat_photo=None, delete_chat_photo=None, group_chat_created=None, supergroup_chat_created=None, channel_chat_created=None, message_auto_delete_timer_changed=None, migrate_to_chat_id=None, migrate_from_chat_id=None, pinned_message=None, invoice=None, successful_payment=None, refunded_payment=None, users_shared=None, chat_shared=None, gift=None, unique_gift=None, connected_website=None, write_access_allowed=None, passport_data=None, proximity_alert_triggered=None, boost_added=None, chat_background_set=None, forum_topic_created=None, forum_topic_edited=None, forum_topic_closed=None, forum_topic_reopened=None, general_forum_topic_hidden=None, general_forum_topic_unhidden=None, giveaway_created=None, giveaway=None, giveaway_winners=None, giveaway_completed=None, paid_message_price_changed=None, video_chat_scheduled=None, video_chat_started=None, video_chat_ended=None, video_chat_participants_invited=None, web_app_data=None, reply_markup=None, forward_date=None, forward_from=None, forward_from_chat=None, forward_from_message_id=None, forward_sender_name=None, forward_signature=None, user_shared=None) edited_message=None channel_post=None edited_channel_post=None business_connection=None business_message=None edited_business_message=None deleted_business_messages=None message_reaction=None message_reaction_count=None inline_query=None chosen_inline_result=None callback_query=None shipping_query=None pre_checkout_query=None purchased_paid_media=None poll=None poll_answer=None my_chat_member=None chat_member=None chat_join_request=None chat_boost=None removed_chat_boost=None
Трассировка: Traceback (most recent call last):
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\storage\memory.py", line 69, in lock
    yield
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\db_middleware.py", line 28, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\role_middleware.py", line 19, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 484, in process_text_answer
    await process_next_step(message, state, session)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 538, in process_next_step
    await show_question(message, state)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 384, in show_question
    await message.edit_text(
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\bot.py", line 478, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 185, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited

2025-07-10 15:39:05 - telegram_bot - WARNING - Ошибка API Telegram: Telegram server says - Bad Request: message can't be edited
2025-07-10 15:39:19 - telegram_bot - ERROR - Исключение: Telegram server says - Bad Request: message can't be edited
Обновление: update_id=258257213 message=Message(message_id=2942, date=datetime.datetime(2025, 7, 10, 12, 39, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=453388874, type='private', title=None, username='Saint_Whirlwind', first_name='Глеб', last_name=None, is_forum=None, accent_color_id=None, active_usernames=None, available_reactions=None, background_custom_emoji_id=None, bio=None, birthdate=None, business_intro=None, business_location=None, business_opening_hours=None, can_set_sticker_set=None, custom_emoji_sticker_set_name=None, description=None, emoji_status_custom_emoji_id=None, emoji_status_expiration_date=None, has_aggressive_anti_spam_enabled=None, has_hidden_members=None, has_private_forwards=None, has_protected_content=None, has_restricted_voice_and_video_messages=None, has_visible_history=None, invite_link=None, join_by_request=None, join_to_send_messages=None, linked_chat_id=None, location=None, message_auto_delete_time=None, permissions=None, personal_chat=None, photo=None, pinned_message=None, profile_accent_color_id=None, profile_background_custom_emoji_id=None, slow_mode_delay=None, sticker_set_name=None, unrestrict_boost_count=None), message_thread_id=None, from_user=User(id=453388874, is_bot=False, first_name='Глеб', last_name=None, username='Saint_Whirlwind', language_code='ru', is_premium=None, added_to_attachment_menu=None, can_join_groups=None, can_read_all_group_messages=None, supports_inline_queries=None, can_connect_to_business=None, has_main_web_app=None), sender_chat=None, sender_boost_count=None, sender_business_bot=None, business_connection_id=None, forward_origin=None, is_topic_message=None, is_automatic_forward=None, reply_to_message=None, external_reply=None, quote=None, reply_to_story=None, via_bot=None, edit_date=None, has_protected_content=None, is_from_offline=None, media_group_id=None, author_signature=None, paid_star_count=None, text='НЕТ', entities=None, link_preview_options=None, effect_id=None, animation=None, audio=None, document=None, paid_media=None, photo=None, sticker=None, story=None, video=None, video_note=None, voice=None, caption=None, caption_entities=None, show_caption_above_media=None, has_media_spoiler=None, contact=None, dice=None, game=None, poll=None, venue=None, location=None, new_chat_members=None, left_chat_member=None, new_chat_title=None, new_chat_photo=None, delete_chat_photo=None, group_chat_created=None, supergroup_chat_created=None, channel_chat_created=None, message_auto_delete_timer_changed=None, migrate_to_chat_id=None, migrate_from_chat_id=None, pinned_message=None, invoice=None, successful_payment=None, refunded_payment=None, users_shared=None, chat_shared=None, gift=None, unique_gift=None, connected_website=None, write_access_allowed=None, passport_data=None, proximity_alert_triggered=None, boost_added=None, chat_background_set=None, forum_topic_created=None, forum_topic_edited=None, forum_topic_closed=None, forum_topic_reopened=None, general_forum_topic_hidden=None, general_forum_topic_unhidden=None, giveaway_created=None, giveaway=None, giveaway_winners=None, giveaway_completed=None, paid_message_price_changed=None, video_chat_scheduled=None, video_chat_started=None, video_chat_ended=None, video_chat_participants_invited=None, web_app_data=None, reply_markup=None, forward_date=None, forward_from=None, forward_from_chat=None, forward_from_message_id=None, forward_sender_name=None, forward_signature=None, user_shared=None) edited_message=None channel_post=None edited_channel_post=None business_connection=None business_message=None edited_business_message=None deleted_business_messages=None message_reaction=None message_reaction_count=None inline_query=None chosen_inline_result=None callback_query=None shipping_query=None pre_checkout_query=None purchased_paid_media=None poll=None poll_answer=None my_chat_member=None chat_member=None chat_join_request=None chat_boost=None removed_chat_boost=None
Трассировка: Traceback (most recent call last):
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\storage\memory.py", line 69, in lock
    yield
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\db_middleware.py", line 28, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\role_middleware.py", line 19, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 484, in process_text_answer
    await process_next_step(message, state, session)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 538, in process_next_step
    await show_question(message, state)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 384, in show_question
    await message.edit_text(
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\bot.py", line 478, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 185, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited

2025-07-10 15:39:19 - telegram_bot - WARNING - Ошибка API Telegram: Telegram server says - Bad Request: message can't be edited
2025-07-10 15:39:26 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) cancelled test. Данные: {'test_id': 1}
2025-07-10 15:39:28 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) took test from notification. Данные: {'test_id': 1}
2025-07-10 15:39:42 - telegram_bot - ERROR - Исключение: Telegram server says - Bad Request: message can't be edited
Обновление: update_id=258257217 message=Message(message_id=2943, date=datetime.datetime(2025, 7, 10, 12, 39, 43, tzinfo=TzInfo(UTC)), chat=Chat(id=453388874, type='private', title=None, username='Saint_Whirlwind', first_name='Глеб', last_name=None, is_forum=None, accent_color_id=None, active_usernames=None, available_reactions=None, background_custom_emoji_id=None, bio=None, birthdate=None, business_intro=None, business_location=None, business_opening_hours=None, can_set_sticker_set=None, custom_emoji_sticker_set_name=None, description=None, emoji_status_custom_emoji_id=None, emoji_status_expiration_date=None, has_aggressive_anti_spam_enabled=None, has_hidden_members=None, has_private_forwards=None, has_protected_content=None, has_restricted_voice_and_video_messages=None, has_visible_history=None, invite_link=None, join_by_request=None, join_to_send_messages=None, linked_chat_id=None, location=None, message_auto_delete_time=None, permissions=None, personal_chat=None, photo=None, pinned_message=None, profile_accent_color_id=None, profile_background_custom_emoji_id=None, slow_mode_delay=None, sticker_set_name=None, unrestrict_boost_count=None), message_thread_id=None, from_user=User(id=453388874, is_bot=False, first_name='Глеб', last_name=None, username='Saint_Whirlwind', language_code='ru', is_premium=None, added_to_attachment_menu=None, can_join_groups=None, can_read_all_group_messages=None, supports_inline_queries=None, can_connect_to_business=None, has_main_web_app=None), sender_chat=None, sender_boost_count=None, sender_business_bot=None, business_connection_id=None, forward_origin=None, is_topic_message=None, is_automatic_forward=None, reply_to_message=None, external_reply=None, quote=None, reply_to_story=None, via_bot=None, edit_date=None, has_protected_content=None, is_from_offline=None, media_group_id=None, author_signature=None, paid_star_count=None, text='НЕТ', entities=None, link_preview_options=None, effect_id=None, animation=None, audio=None, document=None, paid_media=None, photo=None, sticker=None, story=None, video=None, video_note=None, voice=None, caption=None, caption_entities=None, show_caption_above_media=None, has_media_spoiler=None, contact=None, dice=None, game=None, poll=None, venue=None, location=None, new_chat_members=None, left_chat_member=None, new_chat_title=None, new_chat_photo=None, delete_chat_photo=None, group_chat_created=None, supergroup_chat_created=None, channel_chat_created=None, message_auto_delete_timer_changed=None, migrate_to_chat_id=None, migrate_from_chat_id=None, pinned_message=None, invoice=None, successful_payment=None, refunded_payment=None, users_shared=None, chat_shared=None, gift=None, unique_gift=None, connected_website=None, write_access_allowed=None, passport_data=None, proximity_alert_triggered=None, boost_added=None, chat_background_set=None, forum_topic_created=None, forum_topic_edited=None, forum_topic_closed=None, forum_topic_reopened=None, general_forum_topic_hidden=None, general_forum_topic_unhidden=None, giveaway_created=None, giveaway=None, giveaway_winners=None, giveaway_completed=None, paid_message_price_changed=None, video_chat_scheduled=None, video_chat_started=None, video_chat_ended=None, video_chat_participants_invited=None, web_app_data=None, reply_markup=None, forward_date=None, forward_from=None, forward_from_chat=None, forward_from_message_id=None, forward_sender_name=None, forward_signature=None, user_shared=None) edited_message=None channel_post=None edited_channel_post=None business_connection=None business_message=None edited_business_message=None deleted_business_messages=None message_reaction=None message_reaction_count=None inline_query=None chosen_inline_result=None callback_query=None shipping_query=None pre_checkout_query=None purchased_paid_media=None poll=None poll_answer=None my_chat_member=None chat_member=None chat_join_request=None chat_boost=None removed_chat_boost=None
Трассировка: Traceback (most recent call last):
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\storage\memory.py", line 69, in lock
    yield
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\db_middleware.py", line 28, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\role_middleware.py", line 19, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 484, in process_text_answer
    await process_next_step(message, state, session)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 538, in process_next_step
    await show_question(message, state)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 384, in show_question
    await message.edit_text(
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\bot.py", line 478, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 185, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited

2025-07-10 15:39:42 - telegram_bot - WARNING - Ошибка API Telegram: Telegram server says - Bad Request: message can't be edited
2025-07-10 15:39:45 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started bot - already registered
2025-07-10 15:39:46 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) successful login from start. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 15:39:47 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) opened test taking
2025-07-10 15:39:50 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) viewed test details. Данные: {'test_id': 1}
2025-07-10 15:39:54 - telegram_bot - ERROR - Исключение: Telegram server says - Bad Request: message can't be edited
Обновление: update_id=258257222 message=Message(message_id=2948, date=datetime.datetime(2025, 7, 10, 12, 39, 55, tzinfo=TzInfo(UTC)), chat=Chat(id=453388874, type='private', title=None, username='Saint_Whirlwind', first_name='Глеб', last_name=None, is_forum=None, accent_color_id=None, active_usernames=None, available_reactions=None, background_custom_emoji_id=None, bio=None, birthdate=None, business_intro=None, business_location=None, business_opening_hours=None, can_set_sticker_set=None, custom_emoji_sticker_set_name=None, description=None, emoji_status_custom_emoji_id=None, emoji_status_expiration_date=None, has_aggressive_anti_spam_enabled=None, has_hidden_members=None, has_private_forwards=None, has_protected_content=None, has_restricted_voice_and_video_messages=None, has_visible_history=None, invite_link=None, join_by_request=None, join_to_send_messages=None, linked_chat_id=None, location=None, message_auto_delete_time=None, permissions=None, personal_chat=None, photo=None, pinned_message=None, profile_accent_color_id=None, profile_background_custom_emoji_id=None, slow_mode_delay=None, sticker_set_name=None, unrestrict_boost_count=None), message_thread_id=None, from_user=User(id=453388874, is_bot=False, first_name='Глеб', last_name=None, username='Saint_Whirlwind', language_code='ru', is_premium=None, added_to_attachment_menu=None, can_join_groups=None, can_read_all_group_messages=None, supports_inline_queries=None, can_connect_to_business=None, has_main_web_app=None), sender_chat=None, sender_boost_count=None, sender_business_bot=None, business_connection_id=None, forward_origin=None, is_topic_message=None, is_automatic_forward=None, reply_to_message=None, external_reply=None, quote=None, reply_to_story=None, via_bot=None, edit_date=None, has_protected_content=None, is_from_offline=None, media_group_id=None, author_signature=None, paid_star_count=None, text='НЕТ', entities=None, link_preview_options=None, effect_id=None, animation=None, audio=None, document=None, paid_media=None, photo=None, sticker=None, story=None, video=None, video_note=None, voice=None, caption=None, caption_entities=None, show_caption_above_media=None, has_media_spoiler=None, contact=None, dice=None, game=None, poll=None, venue=None, location=None, new_chat_members=None, left_chat_member=None, new_chat_title=None, new_chat_photo=None, delete_chat_photo=None, group_chat_created=None, supergroup_chat_created=None, channel_chat_created=None, message_auto_delete_timer_changed=None, migrate_to_chat_id=None, migrate_from_chat_id=None, pinned_message=None, invoice=None, successful_payment=None, refunded_payment=None, users_shared=None, chat_shared=None, gift=None, unique_gift=None, connected_website=None, write_access_allowed=None, passport_data=None, proximity_alert_triggered=None, boost_added=None, chat_background_set=None, forum_topic_created=None, forum_topic_edited=None, forum_topic_closed=None, forum_topic_reopened=None, general_forum_topic_hidden=None, general_forum_topic_unhidden=None, giveaway_created=None, giveaway=None, giveaway_winners=None, giveaway_completed=None, paid_message_price_changed=None, video_chat_scheduled=None, video_chat_started=None, video_chat_ended=None, video_chat_participants_invited=None, web_app_data=None, reply_markup=None, forward_date=None, forward_from=None, forward_from_chat=None, forward_from_message_id=None, forward_sender_name=None, forward_signature=None, user_shared=None) edited_message=None channel_post=None edited_channel_post=None business_connection=None business_message=None edited_business_message=None deleted_business_messages=None message_reaction=None message_reaction_count=None inline_query=None chosen_inline_result=None callback_query=None shipping_query=None pre_checkout_query=None purchased_paid_media=None poll=None poll_answer=None my_chat_member=None chat_member=None chat_join_request=None chat_boost=None removed_chat_boost=None
Трассировка: Traceback (most recent call last):
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\storage\memory.py", line 69, in lock
    yield
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\db_middleware.py", line 28, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\role_middleware.py", line 19, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 484, in process_text_answer
    await process_next_step(message, state, session)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 538, in process_next_step
    await show_question(message, state)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 384, in show_question
    await message.edit_text(
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\bot.py", line 478, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 185, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited

2025-07-10 15:39:54 - telegram_bot - WARNING - Ошибка API Telegram: Telegram server says - Bad Request: message can't be edited
2025-07-10 15:40:00 - telegram_bot - ERROR - Исключение: Telegram server says - Bad Request: message can't be edited
Обновление: update_id=258257223 message=Message(message_id=2949, date=datetime.datetime(2025, 7, 10, 12, 40, tzinfo=TzInfo(UTC)), chat=Chat(id=453388874, type='private', title=None, username='Saint_Whirlwind', first_name='Глеб', last_name=None, is_forum=None, accent_color_id=None, active_usernames=None, available_reactions=None, background_custom_emoji_id=None, bio=None, birthdate=None, business_intro=None, business_location=None, business_opening_hours=None, can_set_sticker_set=None, custom_emoji_sticker_set_name=None, description=None, emoji_status_custom_emoji_id=None, emoji_status_expiration_date=None, has_aggressive_anti_spam_enabled=None, has_hidden_members=None, has_private_forwards=None, has_protected_content=None, has_restricted_voice_and_video_messages=None, has_visible_history=None, invite_link=None, join_by_request=None, join_to_send_messages=None, linked_chat_id=None, location=None, message_auto_delete_time=None, permissions=None, personal_chat=None, photo=None, pinned_message=None, profile_accent_color_id=None, profile_background_custom_emoji_id=None, slow_mode_delay=None, sticker_set_name=None, unrestrict_boost_count=None), message_thread_id=None, from_user=User(id=453388874, is_bot=False, first_name='Глеб', last_name=None, username='Saint_Whirlwind', language_code='ru', is_premium=None, added_to_attachment_menu=None, can_join_groups=None, can_read_all_group_messages=None, supports_inline_queries=None, can_connect_to_business=None, has_main_web_app=None), sender_chat=None, sender_boost_count=None, sender_business_bot=None, business_connection_id=None, forward_origin=None, is_topic_message=None, is_automatic_forward=None, reply_to_message=None, external_reply=None, quote=None, reply_to_story=None, via_bot=None, edit_date=None, has_protected_content=None, is_from_offline=None, media_group_id=None, author_signature=None, paid_star_count=None, text='Да', entities=None, link_preview_options=None, effect_id=None, animation=None, audio=None, document=None, paid_media=None, photo=None, sticker=None, story=None, video=None, video_note=None, voice=None, caption=None, caption_entities=None, show_caption_above_media=None, has_media_spoiler=None, contact=None, dice=None, game=None, poll=None, venue=None, location=None, new_chat_members=None, left_chat_member=None, new_chat_title=None, new_chat_photo=None, delete_chat_photo=None, group_chat_created=None, supergroup_chat_created=None, channel_chat_created=None, message_auto_delete_timer_changed=None, migrate_to_chat_id=None, migrate_from_chat_id=None, pinned_message=None, invoice=None, successful_payment=None, refunded_payment=None, users_shared=None, chat_shared=None, gift=None, unique_gift=None, connected_website=None, write_access_allowed=None, passport_data=None, proximity_alert_triggered=None, boost_added=None, chat_background_set=None, forum_topic_created=None, forum_topic_edited=None, forum_topic_closed=None, forum_topic_reopened=None, general_forum_topic_hidden=None, general_forum_topic_unhidden=None, giveaway_created=None, giveaway=None, giveaway_winners=None, giveaway_completed=None, paid_message_price_changed=None, video_chat_scheduled=None, video_chat_started=None, video_chat_ended=None, video_chat_participants_invited=None, web_app_data=None, reply_markup=None, forward_date=None, forward_from=None, forward_from_chat=None, forward_from_message_id=None, forward_sender_name=None, forward_signature=None, user_shared=None) edited_message=None channel_post=None edited_channel_post=None business_connection=None business_message=None edited_business_message=None deleted_business_messages=None message_reaction=None message_reaction_count=None inline_query=None chosen_inline_result=None callback_query=None shipping_query=None pre_checkout_query=None purchased_paid_media=None poll=None poll_answer=None my_chat_member=None chat_member=None chat_join_request=None chat_boost=None removed_chat_boost=None
Трассировка: Traceback (most recent call last):
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\storage\memory.py", line 69, in lock
    yield
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\db_middleware.py", line 28, in __call__
    result = await handler(event, data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\middlewares\role_middleware.py", line 19, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 484, in process_text_answer
    await process_next_step(message, state, session)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 538, in process_next_step
    await show_question(message, state)
  File "C:\Users\Shura\Desktop\HRD-bot\test1\handlers\test_taking.py", line 384, in show_question
    await message.edit_text(
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\bot.py", line 478, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 185, in make_request
    response = self.check_response(
               ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Shura\Desktop\HRD-bot\test1\.venv\Lib\site-packages\aiogram\client\session\base.py", line 120, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: message can't be edited

2025-07-10 15:40:00 - telegram_bot - WARNING - Ошибка API Telegram: Telegram server says - Bad Request: message can't be edited
2025-07-10 15:50:46 - telegram_bot - INFO - Завершение работы...
2025-07-10 15:50:46 - telegram_bot - INFO - Бот остановлен
2025-07-10 15:50:46 - telegram_bot - INFO - Бот остановлен по прерыванию с клавиатуры
2025-07-10 15:50:49 - telegram_bot - INFO - Проверка переменных окружения успешно пройдена
2025-07-10 15:50:49 - telegram_bot - INFO - Инициализация базы данных...
2025-07-10 15:50:49 - telegram_bot - INFO - Обновление прав доступа для ролей...
2025-07-10 15:50:49 - telegram_bot - INFO - Право create_tests удалено у роли 2
2025-07-10 15:50:49 - telegram_bot - INFO - Право edit_tests удалено у роли 2
2025-07-10 15:50:49 - telegram_bot - INFO - Удалены права create_tests и edit_tests у роли Сотрудник
2025-07-10 15:50:49 - telegram_bot - INFO - Обновление прав доступа завершено
2025-07-10 15:50:49 - telegram_bot - INFO - Настройка команд бота...
2025-07-10 15:50:50 - telegram_bot - INFO - Запуск бота...
2025-07-10 15:52:19 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started bot - already registered
2025-07-10 15:52:19 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) successful login from start. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 15:52:21 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) opened test taking
2025-07-10 15:52:23 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) viewed test details. Данные: {'test_id': 1}
2025-07-10 15:54:56 - telegram_bot - INFO - Результат теста сохранен для пользователя 4, тест 1
2025-07-10 15:59:25 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 15:59:25 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 15:59:28 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started test creation
2025-07-10 16:02:12 - telegram_bot - INFO - Пользователь 6998855824 (@неизвестен) auto authentication. Данные: {'role': 'Стажер', 'user_id': 3}
2025-07-10 16:03:07 - telegram_bot - INFO - Завершение работы...
2025-07-10 16:03:07 - telegram_bot - INFO - Бот остановлен
2025-07-10 16:03:07 - telegram_bot - INFO - Бот остановлен по прерыванию с клавиатуры
2025-07-10 16:05:02 - telegram_bot - INFO - Проверка переменных окружения успешно пройдена
2025-07-10 16:05:02 - telegram_bot - INFO - Инициализация базы данных...
2025-07-10 16:05:02 - telegram_bot - INFO - Обновление прав доступа для ролей...
2025-07-10 16:05:02 - telegram_bot - INFO - Право create_tests удалено у роли 2
2025-07-10 16:05:02 - telegram_bot - INFO - Право edit_tests удалено у роли 2
2025-07-10 16:05:02 - telegram_bot - INFO - Удалены права create_tests и edit_tests у роли Сотрудник
2025-07-10 16:05:02 - telegram_bot - INFO - Обновление прав доступа завершено
2025-07-10 16:05:02 - telegram_bot - INFO - Настройка команд бота...
2025-07-10 16:05:02 - telegram_bot - INFO - Запуск бота...
2025-07-10 16:05:13 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started bot - already registered
2025-07-10 16:05:14 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) successful login from start. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 16:05:16 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) opened test taking
2025-07-10 16:05:23 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:05:41 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 16:05:41 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 16:05:50 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:06:28 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:06:43 - telegram_bot - INFO - Результат теста сохранен для пользователя 4, тест 1
2025-07-10 16:06:55 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) auto authentication. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 16:06:55 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) viewed test results
2025-07-10 16:11:19 - telegram_bot - INFO - Завершение работы...
2025-07-10 16:11:19 - telegram_bot - INFO - Бот остановлен
2025-07-10 16:11:19 - telegram_bot - INFO - Бот остановлен по прерыванию с клавиатуры
2025-07-10 16:15:35 - telegram_bot - INFO - Проверка переменных окружения успешно пройдена
2025-07-10 16:15:35 - telegram_bot - INFO - Инициализация базы данных...
2025-07-10 16:15:35 - telegram_bot - INFO - Обновление прав доступа для ролей...
2025-07-10 16:15:35 - telegram_bot - INFO - Право create_tests удалено у роли 2
2025-07-10 16:15:35 - telegram_bot - INFO - Право edit_tests удалено у роли 2
2025-07-10 16:15:35 - telegram_bot - INFO - Удалены права create_tests и edit_tests у роли Сотрудник
2025-07-10 16:15:35 - telegram_bot - INFO - Обновление прав доступа завершено
2025-07-10 16:15:35 - telegram_bot - INFO - Настройка команд бота...
2025-07-10 16:15:35 - telegram_bot - INFO - Запуск бота...
2025-07-10 16:16:07 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) started registration
2025-07-10 16:16:13 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) provided full name. Данные: {'full_name': 'Скворцова Софья Павловна'}
2025-07-10 16:16:16 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) provided phone via contact. Данные: {'phone': '+79895147865'}
2025-07-10 16:16:32 - telegram_bot - INFO - Уведомление о новом стажёре 'Скворцова Софья Павловна' отправлено рекрутеру 7197129915
2025-07-10 16:16:32 - telegram_bot - INFO - Уведомление о новом стажёре 'Скворцова Софья Павловна' отправлено рекрутеру 913964240
2025-07-10 16:16:32 - telegram_bot - INFO - Уведомления о новом стажёре отправлены 2/2 рекрутерам
2025-07-10 16:16:33 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) completed registration. Данные: {'role': 'Стажер', 'full_name': 'Скворцова Софья Павловна'}
2025-07-10 16:17:01 - telegram_bot - INFO - Наставник Сова - Сотрудник назначен стажеру Скворцова Софья Павловна
2025-07-10 16:17:01 - telegram_bot - INFO - Уведомление о назначении наставника 'Сова - Сотрудник' отправлено стажеру 766056365
2025-07-10 16:17:01 - telegram_bot - INFO - Уведомление о назначении стажёра 'Скворцова Софья Павловна' отправлено наставнику 7118826824
2025-07-10 16:17:01 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) assigned mentor. Данные: {'mentor_id': 5, 'trainee_id': 7}
2025-07-10 16:17:47 - telegram_bot - INFO - Создан новый доступ к тесту 1 для стажёра 7
2025-07-10 16:17:47 - telegram_bot - INFO - Уведомление о тесте 'Приготовление кофе' отправлено стажеру 766056365
2025-07-10 16:17:47 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) granted test access. Данные: {'test_id': 1, 'trainee_id': 7}
2025-07-10 16:18:03 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) took test from notification. Данные: {'test_id': 1}
2025-07-10 16:18:11 - telegram_bot - INFO - Пользователь 766056365 (@skvortsofa) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:18:18 - telegram_bot - INFO - Доступ к тесту 1 для стажёра 4 уже существует - отправляем повторное уведомление
2025-07-10 16:18:19 - telegram_bot - INFO - Уведомление о тесте 'Приготовление кофе' отправлено стажеру 453388874
2025-07-10 16:18:19 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) granted test access. Данные: {'test_id': 1, 'trainee_id': 4}
2025-07-10 16:18:25 - telegram_bot - INFO - Результат теста сохранен для пользователя 7, тест 1
2025-07-10 16:23:55 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 16:23:55 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 16:24:51 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:34:02 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:35:58 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 16:35:59 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 16:43:46 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) started bot - already registered
2025-07-10 16:43:47 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) successful login from start. Данные: {'role': 'Стажер', 'user_id': 4}
2025-07-10 16:44:07 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started bot - already registered
2025-07-10 16:44:08 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) successful login from start. Данные: {'role': 'Рекрутер', 'user_id': 6}
2025-07-10 16:44:11 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) started test creation
2025-07-10 16:45:10 - telegram_bot - WARNING - Ссылка на материалы не содержит протокол: Файл: Спасибо за внимание.pdf
2025-07-10 16:45:10 - telegram_bot - INFO - Тест 'Готовим КЕКС' создан успешно (ID: 2)
2025-07-10 16:45:10 - telegram_bot - INFO - Пользователь 7197129915 (@EFOR_Development_Department) created test with questions. Данные: {'test_id': 2, 'questions_count': 1}
2025-07-10 16:45:24 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) started bot - already registered
2025-07-10 16:45:25 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) successful login from start. Данные: {'role': 'Сотрудник', 'user_id': 5}
2025-07-10 16:45:30 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) viewed test details. Данные: {'test_id': 1}
2025-07-10 16:45:39 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) viewed test details. Данные: {'test_id': 2}
2025-07-10 16:45:47 - telegram_bot - INFO - Создан новый доступ к тесту 2 для стажёра 4
2025-07-10 16:45:47 - telegram_bot - INFO - Уведомление о тесте 'Готовим КЕКС' отправлено стажеру 453388874
2025-07-10 16:45:47 - telegram_bot - INFO - Пользователь 7118826824 (@SovaTechSales) granted test access. Данные: {'test_id': 2, 'trainee_id': 4}
2025-07-10 16:45:56 - telegram_bot - INFO - Пользователь 453388874 (@Saint_Whirlwind) took test from notification. Данные: {'test_id': 2}
